% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_label_placement.R
\name{estimate_label_height_npc}
\alias{estimate_label_height_npc}
\title{Estimér label højde fra marquee markup VED FAKTISK GROB-MÅLING}
\usage{
estimate_label_height_npc(
  text,
  style = NULL,
  panel_height_inches = NULL,
  fallback_npc = 0.13,
  use_cache = TRUE,
  return_details = FALSE
)
}
\arguments{
\item{text}{Marquee string med font size markup (fx "{.8 \strong{Header}}  \n{.24 \strong{Value}}")}

\item{style}{marquee style object (default: classic_style med right align)}

\item{panel_height_inches}{Panel højde i inches (hvis kendt, ellers NULL for auto-detect)}

\item{fallback_npc}{Fallback værdi hvis grob-måling fejler (default 0.13)}

\item{return_details}{Hvis TRUE, returnér list med npc, inches og panel_height (default FALSE)}
}
\value{
Hvis return_details=FALSE: Numerisk værdi med label højde i NPC (0-1)
Hvis return_details=TRUE: List med:
- npc: Label højde i NPC koordinater
- inches: Label højde i inches (absolut)
- panel_height_inches: Panel højde i inches
}
\description{
Opretter et marquee grob med de faktiske styles og måler højden præcist.
Dette giver korrekt højde på alle panelstørrelser uden magic numbers.
}
\details{
Denne funktion erstatter den tidligere estimation-baserede tilgang med
faktisk måling. Det eliminerer alle magic numbers (pt_to_npc_factor,
line_spacing, safety_margin) og giver præcis højde på:
\itemize{
\item Små paneler (facetter)
\item Store paneler
\item Forskellige base_size værdier
\item Forskellige font families
}
}
\examples{
label <- "{.8 **CL**}  \n{.24 **45\%**}"
style <- marquee::modify_style(
  marquee::classic_style(),
  "p",
  margin = marquee::trbl(0),
  align = "right"
)

# Simpel brug (backward compatible)
height <- estimate_label_height_npc(label, style = style)
# Returns faktisk målt højde (typisk ~0.10-0.15 for 2-line label)

# Detaljeret brug (ny API for fixed gaps)
height_details <- estimate_label_height_npc(label, style = style, return_details = TRUE)
# Returns list(npc = 0.12, inches = 0.5, panel_height_inches = 4.2)
}
