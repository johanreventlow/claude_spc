% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_spc_bfh_service.R
\name{map_to_bfh_params}
\alias{map_to_bfh_params}
\title{Map SPCify Parameters to BFHchart API}
\usage{
map_to_bfh_params(
  data,
  x_var,
  y_var,
  chart_type,
  n_var = NULL,
  cl_var = NULL,
  freeze_var = NULL,
  part_var = NULL,
  notes_column = NULL,
  target_value = NULL,
  centerline_value = NULL,
  ...
)
}
\arguments{
\item{data}{data.frame. Cleaned input data (post-validation).}

\item{x_var}{character. X-axis column name.}

\item{y_var}{character. Y-axis column name.}

\item{chart_type}{character. qicharts2-style chart code (lowercase).}

\item{n_var}{character. Denominator column name (optional).}

\item{cl_var}{character. Centerline override column (optional).}

\item{freeze_var}{character. Freeze indicator column (optional).}

\item{part_var}{character. Phase grouping column (optional).}

\item{notes_column}{character. Name of notes/comment column in data. Will be
mapped to BFHcharts \code{notes} parameter as character vector. Default NULL.}

\item{target_value}{numeric. Target value in SPCify scale (optional).}

\item{centerline_value}{numeric. Custom centerline in SPCify scale (optional).}

\item{...}{Additional parameters to pass through to BFHchart.}
}
\value{
list. Named list of BFHchart-compatible parameters ready for
\code{do.call(BFHchart::create_spc_chart, bfh_params)}. Structure:
\describe{
\item{data}{data.frame with \code{.original_row_id} column}
\item{x}{Bare column name (NSE) for BFHchart}
\item{y}{Bare column name (NSE) for BFHchart}
\item{n}{Bare column name (NSE) or NULL}
\item{chart_type}{Chart type string (BFHchart format)}
\item{freeze}{Integer position or NULL}
\item{part}{Integer vector or NULL (part boundaries)}
\item{target}{Numeric or NULL (normalized scale)}
\item{multiply}{Numeric multiplier}
\item{...}{Additional passthrough parameters}
}
Returns NULL on validation failure (with error logging).
}
\description{
Transforms SPCify-style parameters to BFHchart API conventions. Handles
parameter name mapping, scale normalization (percentage ↔ decimal), and
data structure preparation. Isolates SPCify from BFHchart API changes.
}
\details{
\strong{Transformation Responsibilities:}
\itemize{
\item Column name mapping (x_var, y_var, n_var → BFHchart parameters)
\item Chart type validation and translation
\item Scale normalization (e.g., target 75 → 0.75 for percentage charts)
\item Freeze/part position adjustment for NA-removed rows
\item Row ID injection (\code{.original_row_id}) for comment mapping stability
\item NSE (non-standard evaluation) handling if required by BFHchart
}

\strong{Parameter Mappings (Expected):}
\itemize{
\item SPCify \code{part_var} → BFHchart \code{part} parameter
\item SPCify \code{cl_var} → BFHchart centerline override
\item SPCify \code{freeze_var} → BFHchart \code{freeze} parameter
\item Scale: SPCify percentages (0-100) → BFHchart decimals (0-1) if needed
}
}
\examples{
\dontrun{
# Basic parameter mapping
bfh_params <- map_to_bfh_params(
  data = clean_data,
  x_var = "month",
  y_var = "infections",
  chart_type = "run"
)

# P-chart with scale normalization
bfh_params <- map_to_bfh_params(
  data = clean_data,
  x_var = "date",
  y_var = "complications",
  n_var = "procedures",
  chart_type = "p",
  target_value = 75 # Will be normalized to 0.75
)

# Multi-phase with freeze
bfh_params <- map_to_bfh_params(
  data = clean_data,
  x_var = "week",
  y_var = "defects",
  chart_type = "i",
  freeze_var = "baseline",
  part_var = "phase"
)
}

}
\seealso{
\code{\link{compute_spc_results_bfh}} for facade interface
\code{\link{call_bfh_chart}} for BFHchart invocation
}
