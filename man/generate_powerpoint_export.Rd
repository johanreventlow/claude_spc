% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_export_powerpoint.R
\name{generate_powerpoint_export}
\alias{generate_powerpoint_export}
\title{Generate PowerPoint Export}
\usage{
generate_powerpoint_export(
  plot_object,
  title = "",
  template_path = NULL,
  output_path = NULL
)
}
\arguments{
\item{plot_object}{ggplot object (fra generateSPCPlot eller applyHospitalTheme)}

\item{title}{Character titel til slide (optional, default "")}

\item{template_path}{Path til PowerPoint template (optional, default NULL)}

\item{output_path}{Path til output fil (optional, NULL = create tempfile)}
}
\value{
Character path til genereret PowerPoint fil, eller NULL ved fejl
}
\description{
Genererer PowerPoint export af SPC chart ved at indsætte PNG chart og titel
i en PowerPoint template. Bruger officer package til manipulation af .pptx filer.
}
\details{
PowerPoint generation workflow:
\enumerate{
\item Validate plot object (must be ggplot)
\item Validate template exists (eller use default)
\item Generate temporary PNG at PowerPoint-optimal size (10×7.5 inches @ 96 DPI)
\item Load PowerPoint template med officer::read_pptx()
\item Detect title og body placeholders på slide 1
\item Insert title med officer::ph_with()
\item Insert PNG chart med officer::external_img()
\item Save PowerPoint med print()
\item Cleanup temporary PNG via on.exit()
}

Template handling:
\itemize{
\item Hvis template_path specificeret: Load fra path
\item Hvis template_path NULL: Create default blank presentation
\item Hvis template ikke findes: Return NULL med log error
}

Placeholder detection:
\itemize{
\item Detect standard title og body placeholders via officer::ph_location_type()
\item Fallback til default positioning hvis placeholders ikke findes
}

Chart dimensions:
\itemize{
\item PowerPoint-optimal: 10 inches × 7.5 inches @ 96 DPI
\item Resulterer i 960×720 pixel PNG for embedding
}

Error handling:
\itemize{
\item NULL plot → return NULL med log error
\item Invalid plot (not ggplot) → return NULL med log error
\item Missing template → return NULL med log error
\item PNG generation failure → return NULL med log error
\item PowerPoint generation failure → return NULL med log error
\item All errors logged via log_error()
}
}
\examples{
\dontrun{
# Basic usage
plot <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
generate_powerpoint_export(
  plot_object = plot,
  title = "Min SPC Graf",
  output_path = "output.pptx"
)

# With custom template
generate_powerpoint_export(
  plot_object = plot,
  title = "SPC Oversigt - Kardiologi",
  template_path = "inst/templates/hospital_template.pptx",
  output_path = "export.pptx"
)

# Auto tempfile (for download handlers)
pptx_path <- generate_powerpoint_export(plot, "Titel")
}

}
