% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_label_placement.R
\name{measure_panel_height_from_built}
\alias{measure_panel_height_from_built}
\title{Mål faktisk panel højde fra ggplot}
\usage{
measure_panel_height_from_built(
  built_plot,
  gtable = NULL,
  panel = 1,
  device_width = 7,
  device_height = 7,
  use_cache = TRUE
)
}
\arguments{
\item{built_plot}{ggplot_built object fra ggplot2::ggplot_build()}

\item{gtable}{gtable object fra ggplot2::ggplot_gtable() (optional, genereres hvis NULL)}

\item{panel}{Panel index (default 1)}

\item{device_width}{Device width i inches (kun hvis ingen device er åben)}

\item{device_height}{Device height i inches (kun hvis ingen device er åben)}

\item{p}{ggplot object}
}
\value{
Panel højde i inches, eller NULL hvis måling fejler

Panel højde i inches, eller NULL hvis måling fejler
}
\description{
Ekstraherer den faktiske panel viewport højde fra et ggplot object.
Dette sikrer at NPC-normalisering sker mod korrekt reference (panel, ikke device).
}
\details{
Denne funktion løser problemet hvor ROOT viewport er hele device-fladen
(inkl. margener), mens labels skal normaliseres mod panel-området.

Strategien er:
\enumerate{
\item Build ggplot → gtable
\item Find panel viewport navn fra layout
\item Render på current device (eller temp device hvis ingen er åben)
\item Navigate til panel viewport
\item Mål højde i inches
\item Clean up temp device (hvis oprettet)
}

VIGTIGT: Fra 2025-01-05 er funktionen device-aware:
\itemize{
\item Hvis en device er åben: Brug den (respekter caller's viewport)
\item Hvis ingen device: Åbn temp device med device_width x device_height
}

Mål panel højde fra pre-built ggplot (PERFORMANCE OPTIMIZED)

Denne funktion accepterer et pre-built plot og gtable og måler panel højden
uden at bygge plottet igen.
}
\keyword{internal}
