% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_ui_updates.R
\name{safe_programmatic_ui_update}
\alias{safe_programmatic_ui_update}
\title{Safe Programmatic UI Update Wrapper (Enhanced with Intelligent Flag Clearing)}
\usage{
safe_programmatic_ui_update(
  session,
  app_state,
  update_function,
  delay_ms = NULL
)
}
\arguments{
\item{session}{Shiny session object (must support onFlushed for optimal performance)}

\item{app_state}{Centralized app state with UI protection flags and autodetect state}

\item{update_function}{Function to execute with protection (should contain updateSelectizeInput calls)}

\item{delay_ms}{Delay in milliseconds (default: uses LOOP_PROTECTION_DELAYS$default from constants)}
}
\description{
Advanced wrapper function that prevents circular event loops during programmatic UI updates.
Uses intelligent flag-clearing strategy with session$onFlushed for immediate clearing after
Shiny processes updates, with later::later() safety fallback for robust operation.
}
\details{
KEY FEATURES:
\itemize{
\item Configurable delay from LOOP_PROTECTION_DELAYS constants
\item Single-reset guarantee to prevent double flag clearing
\item session$onFlushed primary strategy for immediate response
\item later::later() safety fallback with double delay
\item Comprehensive timing logging for performance optimization
\item Freeze-aware logging that respects autodetect state without interference
\item Automatic session cleanup on error conditions
}

TIMING STRATEGY:
\enumerate{
\item session$onFlushed(): Immediate clearing after Shiny processes UI updates
\item later::later() fallback: Safety net with 2x delay if onFlushed doesn't fire
\item Synchronous delay: Last resort if later package unavailable
}
}
\examples{
\dontrun{
# Standard usage with default 500ms delay
safe_programmatic_ui_update(session, app_state, function() {
  updateSelectizeInput(session, "x_column", choices = choices, selected = "Dato")
  updateSelectizeInput(session, "y_column", choices = choices, selected = "TÃ¦ller")
})

# Custom delay for slow environments
safe_programmatic_ui_update(session, app_state, function() {
  updateSelectizeInput(session, "x_column", choices = choices, selected = "Dato")
}, delay_ms = LOOP_PROTECTION_DELAYS$conservative)
}

}
